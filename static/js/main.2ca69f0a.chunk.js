(this.webpackJsonplinkbook=this.webpackJsonplinkbook||[]).push([[0],{11:function(e,t){e.exports={SERVER:"https://api.ankitkumarjat.me"}},154:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(15),i=a.n(r),o=a(54),c=a(55),l=a(60),d=a(59),j=a(8),u=a(7),b=a(14),m=a(24);function h(){var e=Object(m.h)().pathname;return Object(n.useEffect)((function(){window.scrollTo(0,0)}),[e]),null}var O=a(17),p=a(159),x=a(195),g=a(208),f=a(225),v=a(202),w=a(228),y=a(49),P=a(209),S=a(210),k=a(124),C=a(207),E=a(211),N=a(212),R=a(213),T=a(214),L=a(226),I=a(205),F=a(215),W=a(198),D=a(108),A=a(116),G=a.n(A),U=a(64),B=a.n(U),M=a(117),z=a.n(M),V=a(115),q=a.n(V),J=a(112),H=a.n(J),$=a(83),Z=a.n($),_=a(113),Y=a.n(_),K=a(111),Q=a.n(K),X=a(114),ee=a.n(X),te=a(109),ae=a.n(te),ne=a(110),se=a.n(ne),re=a(192),ie=a(21),oe=a(123),ce=s.a.createContext(),le=s.a.createContext(),de=a(16),je=a(106),ue=a.n(je),be=a(161),me=a(157),he=a(158),Oe=a(196),pe=a(197),xe=a(199),ge=a(223),fe=a(204),ve=a(206),we=a(67),ye=a.n(we),Pe=a(29),Se=a(11),ke=a(1),Ce=Object(re.a)((function(e){return{modal:{display:"flex",alignItems:"center",justifyContent:"center"},cardRoot:{width:"100%",maxWidth:600,overflow:"auto",margin:e.spacing(2),position:"relative",outline:"none"},media:{minHeight:60,maxHeight:250},image:{maxHeight:250,maxWidth:"100%"},imageWrapper:{display:"flex",justifyContent:"center"},closeBtn:{position:"absolute",right:e.spacing(.5),top:e.spacing(.5)},progressbar:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12},btnWrapper:{position:"relative"},input:{display:"none"}}})),Ee=null;function Ne(){var e=Object(m.g)(),t=Ce(),a=s.a.useContext(ce).authDispatch,n=s.a.useState(!1),r=Object(j.a)(n,2),i=r[0],o=r[1],c=s.a.useState({submit:!1}),l=Object(j.a)(c,2),d=l[0],b=l[1],h=s.a.useState({preview:"",postText:""}),p=Object(j.a)(h,2),g=p[0],f=p[1],v=s.a.useState({postText:!1}),w=Object(j.a)(v,2),y=w[0],P=w[1],S=Object(de.b)().enqueueSnackbar,k=function(){o(!1)},C=function(e){return function(t){"image"===e?(Ee=t.target.files[0],f(Object(u.a)(Object(u.a)({},g),{},{preview:URL.createObjectURL(t.target.files[0])}))):(f(Object(u.a)(Object(u.a)({},g),{},Object(O.a)({},e,t.target.value))),P({postText:!Object(Pe.validatePostText)(t.target.value)}))}};return Object(ke.jsxs)(s.a.Fragment,{children:[Object(ke.jsx)(L.a,{title:"New Post",children:Object(ke.jsx)(x.a,{color:"inherit","aria-label":"add new post",onClick:function(){o(!0)},children:Object(ke.jsx)(ue.a,{})})}),Object(ke.jsx)(be.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:t.modal,open:i,onClose:k,closeAfterTransition:!0,BackdropComponent:me.a,BackdropProps:{timeout:500},children:Object(ke.jsx)(he.a,{in:i,children:Object(ke.jsxs)(Oe.a,{className:t.cardRoot,children:[Object(ke.jsxs)("form",{onSubmit:function(t){if(t.preventDefault(),b({submit:!0}),Object(Pe.validatePostText)(g.postText)){var n=new FormData;Ee&&n.append("image",Ee),n.append("postText",g.postText),fetch("".concat(Se.SERVER,"/posts/create"),{method:"POST",credentials:"include",body:n}).then((function(e){return e.json()})).then((function(t){t.success?(S("Post Created!",{variant:"success"}),f({image:"",postText:""}),o(!1),a({type:"REFPOST"}),e.push("/posts/".concat(t.post._id))):(401===t.status&&a({type:"LOGOUT"}),S(t.message,{variant:"error"})),b({submit:!1})})).catch((function(e){S("Post Creation Failed",{variant:"error"}),b({submit:!1}),console.error("Error:",e)}))}else b({submit:!1}),S("Post text must be 10-255 characters long",{variant:"warning"})},children:[Object(ke.jsx)(pe.a,{className:t.media,children:Object(ke.jsxs)(W.a,{disableGutters:!0,className:t.imageWrapper,children:[Object(ke.jsx)("div",{}),g.preview&&Object(ke.jsx)("img",{src:g.preview,alt:"Post",className:t.image})]})}),Object(ke.jsx)(xe.a,{children:Object(ke.jsx)(ge.a,{fullWidth:!0,id:"postText",label:"Whats Happening?",multiline:!0,rows:4,value:g.postText,onChange:C("postText"),error:y.postText})}),Object(ke.jsxs)(fe.a,{children:[Object(ke.jsxs)("div",{style:{flexGrow:1},children:[Object(ke.jsx)("input",{accept:"image/*",className:t.input,id:"postImage",type:"file",onChange:C("image")}),Object(ke.jsx)("label",{htmlFor:"postImage",children:Object(ke.jsx)(L.a,{title:"Add post image",component:"span",children:Object(ke.jsx)(x.a,{"aria-label":"Add post image",color:"primary",children:Object(ke.jsx)(ye.a,{})})})})]}),Object(ke.jsx)(I.a,{variant:"contained",disableElevation:!0,onClick:k,children:"Close"}),Object(ke.jsxs)("div",{className:t.btnWrapper,children:[Object(ke.jsx)(I.a,{variant:"contained",color:"primary",type:"submit",disableElevation:!0,disabled:d.submit,children:"Create Post"}),d.submit&&Object(ke.jsx)(ve.a,{size:24,className:t.progressbar})]})]})]}),Object(ke.jsx)(fe.a,{className:t.closeBtn,children:Object(ke.jsx)(L.a,{title:"Close",children:Object(ke.jsx)(x.a,{"aria-label":"Close Modal",onClick:k,children:Object(ke.jsx)(B.a,{})})})})]})})})]})}var Re=a(107),Te=a.n(Re);function Le(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now(),a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Intl.RelativeTimeFormat(void 0,{numeric:"auto"}),n=1e3,s=60*n,r=60*s,i=24*r,o=7*i,c=30*i,l=365*i,d=[{ge:l,divisor:l,unit:"year"},{ge:c,divisor:c,unit:"month"},{ge:o,divisor:o,unit:"week"},{ge:i,divisor:i,unit:"day"},{ge:r,divisor:r,unit:"hour"},{ge:s,divisor:s,unit:"minute"},{ge:30*n,divisor:n,unit:"seconds"},{ge:0,divisor:1,text:"just now"}],j="object"===typeof t?t.getTime():new Date(t).getTime(),u=j-("object"===typeof e?e:new Date(e)).getTime(),b=Math.abs(u),m=0,h=d;m<h.length;m++){var O=h[m];if(b>=O.ge){var p=Math.round(Math.abs(u)/O.divisor),x=u<0;return O.unit?a.format(x?p:-p,O.unit):O.text}}}var Ie=Object(re.a)((function(e){return{progressbar:{position:"absolute",top:"50%",left:"50%",marginTop:-15,marginLeft:-15}}}));var Fe=function(){var e=Ie(),t=s.a.useState(null),a=Object(j.a)(t,2),n=a[0],r=a[1],i=s.a.useState(),o=Object(j.a)(i,2),c=o[0],l=o[1],d=Object(de.b)().enqueueSnackbar,u=function(){r(null)},m=c?Object(ke.jsx)(k.a,{anchorEl:n,anchorOrigin:{vertical:"top",horizontal:"left"},id:"account-menu",transformOrigin:{vertical:"bottom",horizontal:"right"},open:Boolean(n),onClose:u,children:c.length>0?c.map((function(e){return Object(ke.jsx)(C.a,{onClick:u,component:b.b,to:"/posts/".concat(e.postId),children:"".concat(e.message," ").concat(Le(e.createdAt))})})):Object(ke.jsx)(C.a,{onClick:u,children:"You have no notifications yet"})}):Object(ke.jsx)(k.a,{anchorEl:n,anchorOrigin:{vertical:"top",horizontal:"left"},id:"account-menu",keepMounted:!0,transformOrigin:{vertical:"bottom",horizontal:"right"},open:Boolean(n),onClose:u,children:Object(ke.jsx)(C.a,{children:Object(ke.jsx)("div",{style:{minWidth:300,minHeight:100},children:Object(ke.jsx)(ve.a,{className:e.progressbar,size:30})})})});return Object(ke.jsxs)(ke.Fragment,{children:[Object(ke.jsx)(L.a,{title:"Notifications",children:Object(ke.jsx)(x.a,{"aria-label":"Notifications",color:"inherit",onClick:function(e){r(e.currentTarget),fetch("".concat(Se.SERVER,"/users/notifications"),{method:"GET",credentials:"include"}).then((function(e){return e.json()})).then((function(e){e.success?l(e.notifications):d(e.message,{variant:"error"})})).catch((function(e){d("Failed to get notifications",{variant:"error"}),console.error("Error:",e)}))},children:Object(ke.jsx)(Te.a,{})})}),m]})},We=Object(re.a)((function(e){return{root:{display:"flex"},drawer:Object(O.a)({},e.breakpoints.up("md"),{width:300,flexShrink:0}),appBar:{zIndex:e.zIndex.drawer+1},menuButton:Object(O.a)({marginRight:e.spacing(2)},e.breakpoints.up("md"),{display:"none"}),toolbar:e.mixins.toolbar,drawerPaper:{width:300},content:{flexGrow:1,paddingTop:e.spacing(3)},grow:{flexGrow:1},mrLeft:{marginLeft:e.spacing(1)},title:{textDecoration:"none"},justCenter:{justifyContent:"center"},avatar:{width:e.spacing(10),height:e.spacing(10)}}}));var De=function(e){var t=e.window,a=We(),n=Object(ie.a)(),r=s.a.useState(!1),i=Object(j.a)(r,2),o=i[0],c=i[1],l=s.a.useContext(ce),d=l.authState,u=l.authDispatch,h=s.a.useState(null),O=Object(j.a)(h,2),A=O[0],U=O[1],M=s.a.useState(null),V=Object(j.a)(M,2),J=V[0],$=V[1],_=Object(m.h)(),K=Object(de.b)().enqueueSnackbar,X=void 0!==t?function(){return t().document.body}:void 0,te=s.a.useState(!0),ne=Object(j.a)(te,2),re=ne[0],je=ne[1],ue=Object(oe.a)(re?{palette:{type:"light",primary:{main:"#00bcd4"}}}:{palette:{type:"dark",primary:{main:"#00bcd4"}}},D.zhCN),be=re?Object(ke.jsx)(se.a,{}):Object(ke.jsx)(ae.a,{}),me=function(){$(null)},he=function(){c(!o)},Oe=function(){o&&c(!o)};s.a.useEffect((function(){d.isAuthenticated&&fetch("".concat(Se.SERVER,"/users/username/").concat(d.username),{method:"GET",credentials:"include"}).then((function(e){return e.json()})).then((function(e){e.success?U(e):(401===e.status&&u({type:"LOGOUT"}),U(null))})).catch((function(e){U(null)}))}),[d,d.refreshUser,u]);var pe=function(){fetch("".concat(Se.SERVER,"/auth/logout"),{method:"DELETE",credentials:"include"}).then((function(e){return e.json()})).then((function(e){if(e.success){K("Logout successfully!",{variant:"success"}),u({type:"LOGOUT"})}else{K("Logout failed!",{variant:"error"})}})).catch((function(e){K("Logout failed!",{variant:"error"})}))},xe=Object(ke.jsxs)("div",{children:[Object(ke.jsx)("div",{className:a.toolbar,children:Object(ke.jsxs)(p.a,{children:[Object(ke.jsx)("div",{className:a.grow}),Object(ke.jsx)(x.a,{"aria-label":"Close Drawer",color:"inherit",onClick:he,children:Object(ke.jsx)(B.a,{})})]})}),Object(ke.jsx)(g.a,{}),A&&Object(ke.jsx)(f.a,{smDown:!0,implementation:"css",children:Object(ke.jsxs)(v.a,{className:a.userInfo,children:[Object(ke.jsx)(p.a,{className:a.justCenter,children:Object(ke.jsx)(x.a,{component:b.b,to:"/users/".concat(A.login),"area-label":"view",style:{padding:0},children:Object(ke.jsx)(w.a,{className:a.avatar,src:A.avatar?"".concat(Se.SERVER).concat(A.avatar):"",alt:"".concat(A.login,"'s avatar")})})}),Object(ke.jsx)(p.a,{className:a.justCenter,dense:!0,children:Object(ke.jsx)(y.a,{variant:"h6",component:b.b,to:"/users/".concat(A.login),color:"inherit",style:{textDecoration:"none"},children:A.login})}),Object(ke.jsx)(p.a,{className:a.justCenter,dense:!0,children:Object(ke.jsxs)(v.a,{style:{display:"flex"},disablePadding:!0,children:[Object(ke.jsxs)(p.a,{style:{display:"flex",flexDirection:"column"},dense:!0,children:[Object(ke.jsx)(y.a,{variant:"body1",children:"Posts"}),Object(ke.jsx)(y.a,{variant:"h6",children:A.posts})]}),Object(ke.jsxs)(p.a,{style:{display:"flex",flexDirection:"column"},dense:!0,children:[Object(ke.jsx)(y.a,{variant:"body1",children:"Followers"}),Object(ke.jsx)(y.a,{variant:"h6",children:A.followers})]}),Object(ke.jsxs)(p.a,{style:{display:"flex",flexDirection:"column"},dense:!0,children:[Object(ke.jsx)(y.a,{variant:"body1",children:"Following"}),Object(ke.jsx)(y.a,{variant:"h6",children:A.following})]})]})})]})}),Object(ke.jsx)(g.a,{}),Object(ke.jsx)(v.a,{children:[{name:"Home",icon:Object(ke.jsx)(Q.a,{}),index:1,to:"/"},{name:"Feed",icon:Object(ke.jsx)(H.a,{}),index:2,to:"/feed"},{name:"Trending",icon:Object(ke.jsx)(Y.a,{}),index:3,to:"/trending"},{name:"Settings",icon:Object(ke.jsx)(ee.a,{}),index:5,to:"/settings"},{name:"My Profile",icon:Object(ke.jsx)(Z.a,{}),index:6,to:"/users/".concat(d.username)}].map((function(e,t){return Object(ke.jsxs)(p.a,{button:!0,selected:_.pathname===e.to,component:b.b,to:e.to,onClick:Oe,children:[Object(ke.jsx)(P.a,{children:e.icon}),Object(ke.jsx)(S.a,{primary:e.name})]},e.index)}))}),Object(ke.jsx)(g.a,{}),Object(ke.jsx)(v.a,{children:Object(ke.jsxs)(p.a,{button:!0,onClick:function(){Oe(),pe()},children:[Object(ke.jsx)(P.a,{children:Object(ke.jsx)(q.a,{})}),Object(ke.jsx)(S.a,{primary:"Logout"})]})})]}),ge=Object(ke.jsxs)(k.a,{anchorEl:J,anchorOrigin:{vertical:"top",horizontal:"left"},id:"account-menu",keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:Boolean(J),onClose:me,children:[Object(ke.jsx)(C.a,{onClick:me,component:b.b,to:"/settings",children:"Account Settings"}),Object(ke.jsx)(C.a,{onClick:me,component:b.b,to:"/users/".concat(d.username),children:"Profile"}),Object(ke.jsx)(C.a,{onClick:function(){me(),pe()},children:"Logout"})]});return Object(ke.jsx)(E.a,{theme:ue,children:Object(ke.jsxs)("div",{className:a.root,children:[Object(ke.jsx)(N.a,{}),Object(ke.jsx)(R.a,{position:"fixed",className:a.appBar,children:Object(ke.jsxs)(T.a,{children:[d.isAuthenticated?Object(ke.jsx)(x.a,{color:"inherit","aria-label":"open drawer",edge:"start",onClick:he,className:a.menuButton,children:Object(ke.jsx)(G.a,{})}):"",Object(ke.jsx)(y.a,{variant:"h6",noWrap:!0,className:a.title,component:b.b,to:"/",color:"inherit",children:"LinkBook"}),Object(ke.jsx)("div",{className:a.grow}),d.isAuthenticated&&Object(ke.jsx)(Ne,{}),Object(ke.jsx)(L.a,{title:"Theme Toggle",children:Object(ke.jsx)(x.a,{"aria-label":"Theme toggle",onClick:function(){je(!re)},color:"inherit",children:be})}),d.isAuthenticated?Object(ke.jsxs)(s.a.Fragment,{children:[Object(ke.jsx)(Fe,{}),Object(ke.jsx)(L.a,{title:"Account",children:Object(ke.jsx)(x.a,{"aria-label":"Current User",color:"inherit",edge:"end","aria-controls":"account-menu","aria-haspopup":"true",onClick:function(e){$(e.currentTarget)},children:Object(ke.jsx)(z.a,{})})})]}):Object(ke.jsxs)(s.a.Fragment,{children:[Object(ke.jsx)(I.a,{color:"inherit",component:b.b,to:"/login",className:a.mrLeft,children:"Login"}),Object(ke.jsx)(I.a,{color:"inherit",component:b.b,to:"/register",className:a.mrLeft,children:"Register"})]})]})}),ge,d.isAuthenticated?Object(ke.jsxs)("nav",{className:a.drawer,"aria-label":"Drawer",children:[Object(ke.jsx)(f.a,{mdUp:!0,implementation:"css",children:Object(ke.jsx)(F.a,{container:X,variant:"temporary",anchor:"rtl"===n.direction?"right":"left",open:o,onClose:he,classes:{paper:a.drawerPaper},ModalProps:{keepMounted:!0},children:xe})}),Object(ke.jsx)(f.a,{smDown:!0,implementation:"css",children:Object(ke.jsx)(F.a,{classes:{paper:a.drawerPaper},variant:"permanent",open:!0,children:xe})})]}):"",Object(ke.jsxs)("main",{className:a.content,children:[Object(ke.jsx)("div",{className:a.toolbar}),Object(ke.jsx)(W.a,{maxWidth:"xl",children:Object(ke.jsx)(le.Provider,{value:A,children:e.children})})]})]})})},Ae=a(222),Ge=a(217),Ue=a(218),Be=a(191),Me=a(216),ze=a(118),Ve=a.n(ze),qe=a(94),Je=a.n(qe),He=a(119),$e=a.n(He),Ze=a(120),_e=a.n(Ze),Ye=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={user:null,isLoading:!0},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;fetch("".concat(Se.SERVER,"/users/avatar?userId=").concat(this.props.comment.userId),{method:"GET",credentials:"include"}).then((function(e){return e.json()})).then((function(t){t.success?e.setState({user:t,isLoading:!1}):e.setState({user:{login:null,avatar:null,userId:e.props.comment.userID},isLoading:!1})})).catch((function(t){e.setState({user:{login:null,avatar:null,userId:e.props.comment.userID},isLoading:!1})}))}},{key:"render",value:function(){return Object(ke.jsx)(s.a.Fragment,{children:Object(ke.jsxs)(xe.a,{style:{display:"flex"},children:[this.state.isLoading?Object(ke.jsx)(Me.a,{animation:"wave",variant:"circle",width:40,height:40}):Object(ke.jsx)(x.a,{component:b.b,to:"/users/".concat(this.state.user.login),"aria-label":"user profile",style:{padding:0,height:"max-content"},children:Object(ke.jsx)(w.a,{"aria-label":"user avatar",src:this.state.user.avatar?"".concat(Se.SERVER).concat(this.state.user.avatar):""})}),Object(ke.jsxs)("div",{style:{marginLeft:16,flexGrow:1},children:[this.state.isLoading?Object(ke.jsx)(Me.a,{animation:"wave",height:10,width:"40%",style:{marginBottom:18}}):Object(ke.jsxs)(y.a,{component:"p",children:[Object(ke.jsx)(y.a,{variant:"subtitle2",component:b.b,to:"/users/".concat(this.state.user.login),color:"inherit",style:{textDecoration:"none"},children:this.state.user.login}),Object(ke.jsx)(y.a,{component:"span",variant:"caption",style:{marginLeft:8},children:Le(this.props.comment.created_at)})]}),this.state.isLoading?Object(ke.jsx)(Me.a,{animation:"wave",height:10,width:"80%",style:{marginBottom:12}}):Object(ke.jsx)(y.a,{component:"p",variant:"body2",style:{marginTop:8},children:this.props.comment.value})]})]})})}}]),a}(n.Component),Ke=Object(re.a)((function(e){return{card:{borderRadius:10,margin:"auto",marginBottom:e.spacing(3)},cardContent:{paddingTop:0,paddingBottom:0},marginLeft:{marginLeft:e.spacing(2)},commentForm:{display:"flex",alignItems:"center"},commentAvatar:{marginRight:e.spacing(2)},progressbar:{position:"absolute",top:"50%",left:"50%",marginTop:-4,marginLeft:-12},noPadding:{padding:0},media:{paddingTop:"56.25%"}}}));function Qe(e){var t=Ke(),a=s.a.useState(!1),n=Object(j.a)(a,2),r=n[0],i=n[1],o=s.a.useState(!0),c=Object(j.a)(o,2),l=c[0],d=c[1],m=s.a.useContext(ce).authDispatch,h=s.a.useState(e.post),O=Object(j.a)(h,2),p=O[0],f=O[1],v=s.a.useState({comment:""}),P=Object(j.a)(v,2),S=P[0],E=P[1],N=s.a.useState(),R=Object(j.a)(N,2),T=R[0],I=R[1],F=s.a.useState(null),W=Object(j.a)(F,2),D=W[0],A=W[1],G=s.a.useContext(le),U=s.a.useState({comment:!1,delete:!1}),B=Object(j.a)(U,2),M=B[0],z=B[1],V=s.a.useState(!1),q=Object(j.a)(V,2),J=q[0],H=q[1],$=Object(de.b)().enqueueSnackbar,Z=new Date(p.created_at).toDateString().split(" "),_=function(){A(null)},Y=Boolean(D),K="post-".concat(p.postId,"-menu"),Q=Object(ke.jsxs)(k.a,{anchorEl:D,anchorOrigin:{vertical:"top",horizontal:"left"},id:K,keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:Y,onClose:_,children:[Object(ke.jsx)(C.a,{onClick:_,disabled:!0,children:"Save Post"}),Object(ke.jsx)(C.a,{onClick:_,disabled:!0,children:"Report post"}),!l&&e.notSkeleton&&p.owner&&G.userId===p.owner.userId&&Object(ke.jsx)("div",{children:Object(ke.jsx)(C.a,{onClick:function(){_(),function(){var e={postId:p.postId};window.confirm("Are you sure you want to delete post?")&&fetch("".concat(Se.SERVER,"/posts/delete"),{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){e.success?($("Post Deleted!",{variant:"success"}),m({type:"REFUSER"}),i(!0)):($(e.message,{variant:"error"}),z({delete:!1}))})).catch((function(e){$("Post deletion failed!",{variant:"error"}),z({delete:!1}),console.error("Error:",e)}))}()},children:Object(ke.jsx)(y.a,{color:"secondary",children:"Delete post"})})})]}),X=function(){fetch("".concat(Se.SERVER,"/posts/like?postId=").concat(p.postId),{method:"POST",credentials:"include"}).then((function(e){return e.json()})).then((function(e){e.success&&(e.success?(e.liked?f(Object(u.a)(Object(u.a)({},p),{},{likes:p.likes+1})):f(Object(u.a)(Object(u.a)({},p),{},{likes:p.likes-1})),I(e.liked)):(401===e.status&&m({type:"logout"}),$(e.message,{variant:"error"})))})).catch((function(e){$("Failed to like post",{variant:"error"})}))};return s.a.useEffect((function(){e.notSkeleton&&p.postId&&fetch("".concat(Se.SERVER,"/posts/like?postId=").concat(p.postId),{method:"GET",credentials:"include"}).then((function(e){return e.json()})).then((function(e){e.success&&I(e.liked),d(!1)})).catch((function(e){d(!1)}))}),[I,p.postId,e.notSkeleton]),Object(ke.jsxs)(s.a.Fragment,{children:[!r&&Object(ke.jsxs)(Oe.a,{className:t.card,variant:"outlined",children:[Object(ke.jsx)(Ge.a,{avatar:!l&&e.notSkeleton?Object(ke.jsx)(x.a,{component:b.b,to:"/users/".concat(p.owner.login),className:t.noPadding,"aria-label":"user profile",children:Object(ke.jsx)(w.a,{"aria-label":"user avatar",alt:p.owner.login,src:p.owner.avatar?"".concat(Se.SERVER).concat(p.owner.avatar):""})}):Object(ke.jsx)(Me.a,{animation:"wave",variant:"circle",width:40,height:40}),action:!l&&e.notSkeleton?Object(ke.jsx)(x.a,{"aria-label":"Post options","aria-controls":K,"aria-haspopup":"true",onClick:function(e){A(e.currentTarget)},children:Object(ke.jsx)(Ve.a,{})}):null,title:l?Object(ke.jsx)(Me.a,{animation:"wave",height:10,width:"80%",style:{marginBottom:6}}):Object(ke.jsx)(y.a,{component:b.b,to:"/users/".concat(p.owner.login),color:"inherit",variant:"body2",style:{textDecoration:"none"},children:p.owner.login}),subheader:l?Object(ke.jsx)(Me.a,{animation:"wave",height:10,width:"40%"}):"".concat(Z[1]," ").concat(Z[2]," ").concat(Z[3])}),!l&&e.notSkeleton?p.postImage&&Object(ke.jsx)(Ue.a,{style:{height:0,paddingTop:"56.25%"},image:"".concat(Se.SERVER).concat(p.postImage),title:"".concat(p.owner.login,"'s post"),alt:p.postImage,to:"/posts/".concat(p.postId),component:e.single?xe.a:b.b}):Object(ke.jsx)(Me.a,{animation:"wave",variant:"rect",className:t.media}),Object(ke.jsx)(xe.a,{children:!l&&e.notSkeleton?Object(ke.jsx)(y.a,{component:"p",children:p.postText}):Object(ke.jsxs)(s.a.Fragment,{children:[Object(ke.jsx)(Me.a,{animation:"wave",height:10,style:{marginBottom:6}}),Object(ke.jsx)(Me.a,{animation:"wave",height:10,width:"80%"})]})}),!l&&e.notSkeleton?Object(ke.jsxs)(y.a,{className:t.marginLeft,variant:"subtitle2",component:"p",children:[p.likes," ",p.like>1?"Likes":"Like",Object(ke.jsxs)(y.a,{component:"span",variant:"subtitle2",className:t.marginLeft,children:[p.comments," ",p.comments>1?"Comments":"Comment"]})]}):Object(ke.jsx)(Me.a,{animation:"wave",height:10,width:"50%",style:{marginLeft:16,marginBottom:11}}),Object(ke.jsx)(fe.a,{disableSpacing:!0,children:e.notSkeleton?Object(ke.jsxs)(s.a.Fragment,{children:[T?Object(ke.jsx)(L.a,{title:"Unlike this",children:Object(ke.jsx)(x.a,{"aria-label":"unlike",onClick:X,color:"primary",children:Object(ke.jsx)(Je.a,{color:"inherit"})})}):Object(ke.jsx)(L.a,{title:"Like this",children:Object(ke.jsx)(x.a,{"aria-label":"like",onClick:X,children:Object(ke.jsx)(Je.a,{})})}),Object(ke.jsx)(L.a,{title:"Comments",children:Object(ke.jsx)(x.a,{className:t.marginLeft,"aria-label":"comment",onClick:function(){H(!J)},children:Object(ke.jsx)($e.a,{})})})]}):Object(ke.jsx)("div",{style:{height:36}})}),Object(ke.jsxs)(Be.a,{in:J,timeout:"auto",unmountOnExit:!0,children:[Object(ke.jsx)(g.a,{}),Object(ke.jsx)(xe.a,{children:Object(ke.jsxs)("form",{onSubmit:function(e){if(e.preventDefault(),S.comment){z({comment:!0});var t={postId:p.postId,value:S.comment};fetch("".concat(Se.SERVER,"/posts/comment"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(e){if(e.success){E({comment:""}),$(e.message,{variant:"success"});var t=p.commentslist;t.unshift(e),f(Object(u.a)(Object(u.a)({},p),{},{comments:p.comments+1,commentslist:t}))}else 401===e.status&&m({type:"logout"}),$(e.message,{variant:"error"});z({comment:!1})})).catch((function(e){$("Failed to get post",{variant:"error"}),z({comment:!1}),console.error("Error:",e)}))}else $("Comment can't be empty",{variant:"warning"})},className:t.commentForm,children:[G&&Object(ke.jsx)(w.a,{src:G.avatar?"".concat(Se.SERVER).concat(G.avatar):"",className:t.commentAvatar}),Object(ke.jsx)(ge.a,{id:"commentInput",label:"Write a comment...",onChange:function(e){E(Object(u.a)(Object(u.a)({},S),{},{comment:e.target.value}))},value:S.comment,fullWidth:!0}),Object(ke.jsxs)("div",{style:{position:"relative"},children:[Object(ke.jsx)(L.a,{title:"Add Comment",children:Object(ke.jsx)(x.a,{"aria-label":"add comment",color:"primary",type:"submit",disabled:M.comment,children:Object(ke.jsx)(_e.a,{})})}),M.comment&&Object(ke.jsx)(ve.a,{size:24,className:t.progressbar})]})]})}),e.notSkeleton&&p.commentslist.map((function(e){return Object(ke.jsx)(Ye,{comment:e},e.commentId)}))]})]}),Q]})}var Xe=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={data:null,loadMore:!1,nextPage:1},e.nullPost={postId:null,userId:null,postImage:null,postText:null,created_at:null},e.getPosts=function(t){fetch("".concat(Se.SERVER).concat(e.props.url,"?page=").concat(t),{method:"GET",credentials:"include"}).then((function(e){return e.json()})).then((function(t){t.success?e.state.nextPage>1?e.setState(Object(u.a)(Object(u.a)({},e.state),{},{data:{next:t.next,posts:e.state.data.posts.concat(t.posts)},nextPage:e.state.nextPage+1,loadMore:!1})):e.setState(Object(u.a)(Object(u.a)({},e.state),{},{data:t,nextPage:e.state.nextPage+1,loadMore:!1})):e.setState(Object(u.a)(Object(u.a)({},e.state),{},{nextPage:e.state.nextPage-1,loadMore:!1}))})).catch((function(t){e.setState(Object(u.a)(Object(u.a)({},e.state),{},{nextPage:e.state.nextPage-1,loadMore:!1})),console.error("Error:",t)}))},e.handleLoadMore=function(){e.setState(Object(u.a)(Object(u.a)({},e.state),{},{loadMore:!0})),e.getPosts(e.state.nextPage)},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.getPosts(this.state.nextPage)}},{key:"componentDidUpdate",value:function(e){this.props.authState.refreshPost!==e.authState.refreshPost&&(this.setState(Object(u.a)(Object(u.a)({},this.state),{},{nextPage:1})),this.getPosts(1))}},{key:"render",value:function(){return Object(ke.jsxs)(s.a.Fragment,{children:[this.state.data?this.state.data.posts.map((function(e){return Object(ke.jsx)(Qe,{post:e,notSkeleton:!0},e.postId)})):Object(ke.jsxs)(s.a.Fragment,{children:[Object(ke.jsx)(Qe,{notSkeleton:!1,post:this.nullPost},"skelton1"),Object(ke.jsx)(Qe,{notSkeleton:!1,post:this.nullPost},"skelton2")]}),this.state.data&&this.state.data.next&&Object(ke.jsxs)(Ae.a,{display:"flex",justifyContent:"center",style:{position:"relative",marginBottom:24},children:[Object(ke.jsx)(I.a,{variant:"outlined",color:"primary",onClick:this.handleLoadMore,disabled:this.state.loadMore,children:"Load More"}),this.state.loadMore&&Object(ke.jsx)(ve.a,{size:24,style:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}})]})]})}}]),a}(n.Component),et=Object(re.a)((function(e){return{root:Object(O.a)({display:"flex"},e.breakpoints.up("sm"),{margin:e.spacing(2)}),marginBottom:{marginBottom:e.spacing(3)}}}));var tt=function(){var e=s.a.useContext(ce).authState,t=et(),a=Object(m.g)(),n=Object(m.h)().search,r=new URLSearchParams(n).get("page");return s.a.useEffect((function(){r&&a.push(r)})),Object(ke.jsx)(s.a.Fragment,{children:Object(ke.jsx)(Ae.a,{className:t.root,children:Object(ke.jsxs)(W.a,{maxWidth:"sm",disableGutters:!0,children:[Object(ke.jsx)(y.a,{variant:"h4",className:t.marginBottom,children:"Latest Posts"}),Object(ke.jsx)(Xe,{authState:e,url:"/posts/"})]})})})},at=a(68),nt=a.n(at),st=a(84),rt=a(201),it=a(227),ot=a(200),ct=a(219),lt=a(220),dt=a(47),jt=a.n(dt),ut=a(48),bt=a.n(ut),mt=a(72),ht=a.n(mt),Ot=a(85),pt=a.n(Ot),xt=a(3),gt=Object(re.a)((function(e){return{margin:{marginTop:e.spacing(3)},relative:{position:"relative"},progressbar:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}}}));var ft=function(){var e=gt(),t=s.a.useState({email:"",password:"",showPassword:!1}),a=Object(j.a)(t,2),n=a[0],r=a[1],i=s.a.useState({email:!1,password:!1}),o=Object(j.a)(i,2),c=o[0],l=o[1],d=s.a.useState({submit:!1}),m=Object(j.a)(d,2),h=m[0],p=m[1],g=Object(de.b)().enqueueSnackbar,f=s.a.useContext(ce).authDispatch,v=function(e){return function(t){r(Object(u.a)(Object(u.a)({},n),{},Object(O.a)({},e,t.target.value))),"email"===e?l({email:!Object(Pe.validateEmail)(t.target.value)}):"password"===e&&l({password:!Object(Pe.validatePassword)(t.target.value)})}},w=function(){var e=Object(st.a)(nt.a.mark((function e(t){var a;return nt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),c.email||c.password||!n.password||!n.email){e.next=8;break}return p({submit:!0}),a={email:n.email,password:n.password},e.next=6,fetch("".concat(Se.SERVER,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(a)}).then((function(e){return e.json()})).then((function(e){e.success?(g("Login successfully!",{variant:"success"}),f({type:"LOGIN",payload:e})):(g(e.message,{variant:"error"}),p({submit:!1}))})).catch((function(e){g("Login failed!",{variant:"error"}),p({submit:!1}),console.error("Error:",e)}));case 6:e.next=9;break;case 8:g("Email and Password should be valid.",{variant:"warning"});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(ke.jsx)(s.a.Fragment,{children:Object(ke.jsx)(W.a,{maxWidth:"xs",disableGutters:!0,children:Object(ke.jsx)(Ae.a,{mt:5,children:Object(ke.jsxs)("form",{onSubmit:w,children:[Object(ke.jsx)(y.a,{variant:"h4",color:"initial",children:"Log In"}),Object(ke.jsx)(y.a,{variant:"body1",color:"inherit",children:"with your LinkBook account"}),Object(ke.jsxs)(Ae.a,{mt:2,children:[Object(ke.jsxs)(rt.a,{fullWidth:!0,className:e.margin,error:c.email,children:[Object(ke.jsx)(it.a,{htmlFor:"userEmail",children:"Email"}),Object(ke.jsx)(ot.a,{id:"userEmail",type:"email",value:n.email,onChange:v("email"),startAdornment:Object(ke.jsx)(ct.a,{position:"start",children:Object(ke.jsx)(pt.a,{})})})]}),Object(ke.jsxs)(rt.a,{fullWidth:!0,className:e.margin,error:c.password,children:[Object(ke.jsx)(it.a,{htmlFor:"userPassword",children:"Password"}),Object(ke.jsx)(ot.a,{id:"userPassword",type:n.showPassword?"text":"password",value:n.password,onChange:v("password"),startAdornment:Object(ke.jsx)(ct.a,{position:"start",children:Object(ke.jsx)(ht.a,{})}),endAdornment:Object(ke.jsx)(ct.a,{position:"end",children:Object(ke.jsx)(x.a,{"aria-label":"toggle password visibility",onClick:function(){r(Object(u.a)(Object(u.a)({},n),{},{showPassword:!n.showPassword}))},onMouseDown:function(e){e.preventDefault()},children:n.showPassword?Object(ke.jsx)(jt.a,{}):Object(ke.jsx)(bt.a,{})})})})]}),Object(ke.jsx)(rt.a,{className:e.margin,children:Object(ke.jsx)(lt.a,{component:b.b,to:"/forgetpass",color:"primary",children:"Forgot Your Password?"})}),Object(ke.jsxs)(rt.a,{fullWidth:!0,className:Object(xt.a)(e.margin,e.relative),children:[Object(ke.jsx)(I.a,{variant:"contained",color:"primary",disabled:h.submit,type:"submit",children:"Log In"}),h.submit&&Object(ke.jsx)(ve.a,{size:24,className:e.progressbar})]}),Object(ke.jsxs)(y.a,{variant:"subtitle1",color:"initial",className:e.margin,align:"center",children:["Not registered? ",Object(ke.jsx)(lt.a,{component:b.b,to:"/register",color:"primary",children:"Create a account"})]})]})]})})})})},vt=a(203),wt=Object(re.a)((function(e){return{margin:{marginTop:e.spacing(3)},relative:{position:"relative"},progressbar:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}}}));var yt=function(){var e=wt(),t=s.a.useState({username:"",email:"",password:"",confirmPassword:"",showPassword:!1,showConfirmPassword:!1}),a=Object(j.a)(t,2),n=a[0],r=a[1],i=s.a.useState({username:!1,email:!1,password:!1,confirmPassword:!1}),o=Object(j.a)(i,2),c=o[0],l=o[1],d=s.a.useState({submit:!1}),h=Object(j.a)(d,2),p=h[0],g=h[1],f=Object(de.b)().enqueueSnackbar,v=Object(m.g)(),w=function(e){return function(t){r(Object(u.a)(Object(u.a)({},n),{},Object(O.a)({},e,t.target.value))),"email"===e?l({email:!Object(Pe.validateEmail)(t.target.value)}):"password"===e?l({password:!Object(Pe.validatePassword)(t.target.value)}):"username"===e?l({username:!Object(Pe.validateUsername)(t.target.value)}):"confirmPassword"===e&&l({confirmPassword:t.target.value!==n.password})}},P=function(e){e.preventDefault()},S=function(){var e=Object(st.a)(nt.a.mark((function e(t){var a;return nt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),c.email||c.password||!n.username||!n.password||!n.email||!n.confirmPassword){e.next=8;break}return g({submit:!0}),a={username:n.username,email:n.email,password:n.password,confirmPassword:n.confirmPassword},e.next=6,fetch("".concat(Se.SERVER,"/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(a)}).then((function(e){return e.json()})).then((function(e){if(e.success){f("Registered successfully!",{variant:"success"}),v.push("/login")}else{f(e.message,{variant:"error"}),g({submit:!1})}})).catch((function(e){f("Registration failed!",{variant:"error"}),g({submit:!1}),console.error("Error:",e)}));case 6:e.next=9;break;case 8:f("Username, Email and Password should be valid.",{variant:"warning"});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(ke.jsx)(s.a.Fragment,{children:Object(ke.jsx)(W.a,{maxWidth:"xs",disableGutters:!0,children:Object(ke.jsx)(Ae.a,{mt:5,children:Object(ke.jsxs)("form",{onSubmit:S,children:[Object(ke.jsx)(y.a,{variant:"h4",color:"initial",children:"Register"}),Object(ke.jsx)(y.a,{variant:"body1",color:"inherit",children:"to manage your account on LinkBook"}),Object(ke.jsxs)(Ae.a,{mt:2,children:[Object(ke.jsxs)(rt.a,{fullWidth:!0,className:e.margin,error:c.username,children:[Object(ke.jsx)(it.a,{htmlFor:"userUsername",children:"Username"}),Object(ke.jsx)(ot.a,{id:"userUsername",type:"text",value:n.username,onChange:w("username"),startAdornment:Object(ke.jsx)(ct.a,{position:"start",children:Object(ke.jsx)(Z.a,{})})})]}),Object(ke.jsxs)(rt.a,{fullWidth:!0,className:e.margin,error:c.email,children:[Object(ke.jsx)(it.a,{htmlFor:"userEmail",children:"Email"}),Object(ke.jsx)(ot.a,{id:"userEmail",type:"email",value:n.email,onChange:w("email"),startAdornment:Object(ke.jsx)(ct.a,{position:"start",children:Object(ke.jsx)(pt.a,{})})})]}),Object(ke.jsxs)(rt.a,{fullWidth:!0,className:e.margin,error:c.password,children:[Object(ke.jsx)(it.a,{htmlFor:"userPassword",children:"Password"}),Object(ke.jsx)(ot.a,{id:"userPassword",type:n.showPassword?"text":"password",value:n.password,onChange:w("password"),startAdornment:Object(ke.jsx)(ct.a,{position:"start",children:Object(ke.jsx)(ht.a,{})}),endAdornment:Object(ke.jsx)(ct.a,{position:"end",children:Object(ke.jsx)(x.a,{"aria-label":"toggle password visibility",onClick:function(){r(Object(u.a)(Object(u.a)({},n),{},{showPassword:!n.showPassword}))},onMouseDown:P,children:n.showPassword?Object(ke.jsx)(jt.a,{}):Object(ke.jsx)(bt.a,{})})})}),Object(ke.jsx)(vt.a,{children:"Use 8 or more characters with a mix of letters, numbers & symbols"})]}),Object(ke.jsxs)(rt.a,{fullWidth:!0,className:e.margin,error:c.confirmPassword,children:[Object(ke.jsx)(it.a,{htmlFor:"userConfirmPassword",children:"Confirm Password"}),Object(ke.jsx)(ot.a,{id:"userConfirmPassword",type:n.showConfirmPassword?"text":"password",value:n.confirmPassword,onChange:w("confirmPassword"),startAdornment:Object(ke.jsx)(ct.a,{position:"start",children:Object(ke.jsx)(ht.a,{})}),endAdornment:Object(ke.jsx)(ct.a,{position:"end",children:Object(ke.jsx)(x.a,{"aria-label":"toggle confirm password visibility",onClick:function(){r(Object(u.a)(Object(u.a)({},n),{},{showConfirmPassword:!n.showConfirmPassword}))},onMouseDown:P,children:n.showConfirmPassword?Object(ke.jsx)(jt.a,{}):Object(ke.jsx)(bt.a,{})})})})]}),Object(ke.jsxs)(rt.a,{fullWidth:!0,className:Object(xt.a)(e.margin,e.relative),children:[Object(ke.jsx)(I.a,{variant:"contained",color:"primary",type:"submit",disabled:p.submit,children:"Register"}),p.submit&&Object(ke.jsx)(ve.a,{size:24,className:e.progressbar})]}),Object(ke.jsxs)(y.a,{variant:"subtitle1",color:"initial",className:e.margin,align:"center",children:["Do you have an account? ",Object(ke.jsx)(lt.a,{color:"primary",component:b.b,to:"/login",children:"Login"})]})]})]})})})})},Pt=a(121),St=a.n(Pt),kt=Object(re.a)((function(e){return{modal:{display:"flex",alignItems:"center",justifyContent:"center"},cardRoot:{width:"100%",maxWidth:600,overflow:"auto",margin:e.spacing(2),position:"relative",outline:"none"},media:{minHeight:60,maxHeight:250},image:{maxHeight:250,maxWidth:"100%"},flexCenter:{display:"flex",justifyContent:"center"},progressbar:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12},btnWrapper:{position:"relative"},input:{display:"none"}}})),Ct=null;function Et(){var e=kt(),t=s.a.useContext(ce).authDispatch,a=s.a.useState(!1),n=Object(j.a)(a,2),r=n[0],i=n[1],o=s.a.useState({submit:!1}),c=Object(j.a)(o,2),l=c[0],d=c[1],b=s.a.useState({preview:""}),m=Object(j.a)(b,2),h=m[0],O=m[1],p=Object(de.b)().enqueueSnackbar,f=function(){i(!1)};return Object(ke.jsxs)(s.a.Fragment,{children:[Object(ke.jsx)(L.a,{title:"Change avatar",children:Object(ke.jsx)(x.a,{color:"primary","aria-label":"add new post",onClick:function(){i(!0)},children:Object(ke.jsx)(ye.a,{})})}),Object(ke.jsx)(be.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:e.modal,open:r,onClose:f,closeAfterTransition:!0,BackdropComponent:me.a,BackdropProps:{timeout:500},children:Object(ke.jsx)(he.a,{in:r,children:Object(ke.jsx)(Oe.a,{className:e.cardRoot,children:Object(ke.jsxs)("form",{onSubmit:function(e){if(e.preventDefault(),d({submit:!0}),Ct){var a=new FormData;a.append("image",Ct),fetch("".concat(Se.SERVER,"/users/update-avatar"),{method:"POST",credentials:"include",body:a}).then((function(e){return e.json()})).then((function(e){e.success?(p("Avatar Updated!",{variant:"success"}),O({preview:""}),i(!1),t({type:"REFUSER"})):(401===e.status&&t({type:"LOGOUT"}),p(e.message,{variant:"error"}),O({preview:""})),d({submit:!1})})).catch((function(e){p("Avatar updation Failed",{variant:"error"}),O({preview:""}),d({submit:!1}),console.error("Error:",e)}))}else d({submit:!1}),p("You need to select an image",{variant:"warning"})},children:[Object(ke.jsx)(Ge.a,{action:Object(ke.jsx)(L.a,{title:"Close",children:Object(ke.jsx)(x.a,{"aria-label":"Close Modal",onClick:f,children:Object(ke.jsx)(B.a,{})})}),title:"Update Avatar"}),Object(ke.jsx)(pe.a,{className:e.media,children:Object(ke.jsxs)(W.a,{disableGutters:!0,className:e.flexCenter,children:[Object(ke.jsx)("input",{accept:"image/*",className:e.input,id:"postImage",type:"file",onChange:function(e){Ct=e.target.files[0],O(Object(u.a)(Object(u.a)({},h),{},{preview:URL.createObjectURL(e.target.files[0])}))}}),h.preview?Object(ke.jsx)("img",{src:h.preview,alt:"Post",className:e.image}):Object(ke.jsx)("label",{htmlFor:"postImage",children:Object(ke.jsx)(L.a,{title:"Select Avatar Image",component:"span",children:Object(ke.jsx)(I.a,{variant:"contained","aria-label":"select avatar image",color:"primary",startIcon:Object(ke.jsx)(ye.a,{}),children:"Select Avatar Image"})})})]})}),Object(ke.jsx)(xe.a,{className:e.flexCenter,children:h.preview&&Object(ke.jsx)("label",{htmlFor:"postImage",children:Object(ke.jsx)(L.a,{title:"Select other image",component:"span",children:Object(ke.jsx)(I.a,{variant:"contained","aria-label":"select avatar image",color:"primary",startIcon:Object(ke.jsx)(ye.a,{}),children:"Select other Image"})})})}),Object(ke.jsx)(g.a,{}),Object(ke.jsxs)(fe.a,{children:[Object(ke.jsx)("div",{style:{flexGrow:1}}),Object(ke.jsx)(I.a,{variant:"contained",disableElevation:!0,onClick:f,children:"Close"}),Object(ke.jsxs)("div",{className:e.btnWrapper,children:[Object(ke.jsx)(I.a,{variant:"contained",color:"primary",type:"submit",disableElevation:!0,disabled:l.submit,children:"Update Avatar"}),l.submit&&Object(ke.jsx)(ve.a,{size:24,className:e.progressbar})]})]})]})})})})]})}var Nt=Object(re.a)((function(e){return{progressbar:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12},btnWrapper:{position:"relative",marginRight:e.spacing(1)}}}));var Rt=function(e){var t=Nt(),a=s.a.useState(!1),n=Object(j.a)(a,2),r=n[0],i=n[1],o=s.a.useState(!1),c=Object(j.a)(o,2),l=c[0],d=c[1],u=s.a.useContext(ce).authDispatch,b=Object(de.b)().enqueueSnackbar;return s.a.useEffect((function(){fetch("".concat(Se.SERVER,"/users/follow?userId=").concat(e.userId),{method:"GET",credentials:"include"}).then((function(e){return e.json()})).then((function(e){e.success?e.follow?i(!0):i(!1):(b(e.message,{variant:"error"}),i(!1))})).catch((function(e){}))}),[i,e.userId,b]),Object(ke.jsx)(s.a.Fragment,{children:Object(ke.jsxs)("div",{className:t.btnWrapper,children:[Object(ke.jsx)(I.a,{variant:"contained",color:"primary",disableElevation:!0,onClick:function(){d(!0);var t={userId:e.userId};fetch("".concat(Se.SERVER,"/users/follow?userId=").concat(e.userId),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(e){e.success?(i(!r),u({type:"REFUSER"}),b(e.message,{variant:"success"})):b(e.message,{variant:"error"}),d(!1)})).catch((function(e){b("Request failed!",{variant:"error"}),d(!1),console.log(e)}))},disabled:l,children:r?"Unfollow":"Follow"}),l&&Object(ke.jsx)(ve.a,{size:24,className:t.progressbar})]})})},Tt=Object(re.a)((function(e){return{box:Object(O.a)({},e.breakpoints.up("md"),{margin:e.spacing(2)}),gutters:Object(O.a)({},e.breakpoints.up("sm"),{paddingLeft:e.spacing(3.5)}),avatar:{width:e.spacing(25),height:e.spacing(25)},avatarBox:{position:"relative",width:e.spacing(25),height:e.spacing(25)},flex:{display:"flex"},mainFlex:Object(O.a)({flexDirection:"column"},e.breakpoints.up("sm"),{flexDirection:"row"}),avatarWrapper:Object(O.a)({width:"100%"},e.breakpoints.up("sm"),{width:e.spacing(30)}),mrLeft:{marginLeft:e.spacing(1)},mrRight:{marginRight:e.spacing(1)},justCenter:{justifyContent:"center"}}}));var Lt=function(e){var t=Tt(),a=s.a.useContext(ce),n=a.authState,r=a.authDispatch,i=Object(m.i)().username,o=s.a.useState(),c=Object(j.a)(o,2),l=c[0],d=c[1],u=Object(de.b)().enqueueSnackbar;return s.a.useEffect((function(){fetch("".concat(Se.SERVER,"/users/username/").concat(i),{method:"GET",credentials:"include"}).then((function(e){return e.json()})).then((function(e){e.success?d(e):(401===e.status&&r({type:"LOGOUT"}),u(e.message,{variant:"error"}))})).catch((function(e){u("Failed to get user data",{variant:"error"})}))}),[i,u,n.refreshPost,n.refreshUser,r]),Object(ke.jsx)(s.a.Fragment,{children:l?Object(ke.jsx)(s.a.Fragment,{children:Object(ke.jsx)(Ae.a,{className:t.box,children:Object(ke.jsx)(W.a,{maxWidth:"md",disableGutters:!0,children:Object(ke.jsxs)(v.a,{className:Object(xt.a)(t.flex,t.mainFlex),children:[Object(ke.jsx)(p.a,{className:Object(xt.a)(t.avatarWrapper,t.justCenter),children:Object(ke.jsxs)(Ae.a,{className:t.avatarBox,children:[Object(ke.jsx)(w.a,{alt:"".concat(l.login,"'s avatar"),src:l.avatar?"".concat(Se.SERVER).concat(l.avatar):"",className:t.avatar}),n.userId===l.userId&&Object(ke.jsx)(Ae.a,{position:"absolute",style:{bottom:0,right:0},children:Object(ke.jsx)(Et,{})})]})}),Object(ke.jsx)(p.a,{disableGutters:!0,className:t.gutters,children:Object(ke.jsxs)(v.a,{style:{width:"100%"},children:[Object(ke.jsxs)(p.a,{disableGutters:!0,children:[Object(ke.jsx)(y.a,{variant:"h4",style:{flexGrow:1},children:l.login}),n.userId===l.userId&&Object(ke.jsx)(I.a,{variant:"contained",color:"primary",startIcon:Object(ke.jsx)(St.a,{}),component:b.b,to:"/settings",children:" edit"})]}),Object(ke.jsx)(p.a,{dense:!0,disableGutters:!0,children:Object(ke.jsx)(y.a,{variant:"body2",children:l.bio?l.bio:""})}),Object(ke.jsx)(p.a,{dense:!0,disableGutters:!0,children:Object(ke.jsx)(y.a,{variant:"body1",children:l.location?l.location:""})}),Object(ke.jsx)(p.a,{dense:!0,disableGutters:!0,children:Object(ke.jsx)(y.a,{variant:"body1",href:l.website?l.website:"",target:"_blank",component:lt.a,children:l.website?"Website Link":null})}),Object(ke.jsx)(p.a,{disableGutters:!0,children:n.userId!==l.userId&&Object(ke.jsx)(Rt,{userId:l.userId})}),Object(ke.jsx)(p.a,{dense:!0,disableGutters:!0,children:Object(ke.jsxs)(v.a,{className:t.flex,children:[Object(ke.jsxs)(p.a,{disableGutters:!0,children:[Object(ke.jsx)(y.a,{className:Object(xt.a)(t.mrRight),variant:"h6",children:l.posts}),Object(ke.jsx)(y.a,{variant:"body1",className:t.mrRight,children:"Posts"})]}),Object(ke.jsx)(g.a,{orientation:"vertical",flexItem:!0}),Object(ke.jsxs)(p.a,{disableGutters:!0,children:[Object(ke.jsx)(y.a,{className:Object(xt.a)(t.mrRight,t.mrLeft),variant:"h6",children:l.followers}),Object(ke.jsx)(y.a,{variant:"body1",className:t.mrRight,children:"Followers"})]}),Object(ke.jsx)(g.a,{orientation:"vertical",flexItem:!0}),Object(ke.jsxs)(p.a,{disableGutters:!0,children:[Object(ke.jsx)(y.a,{className:Object(xt.a)(t.mrRight,t.mrLeft),variant:"h6",children:l.following}),Object(ke.jsx)(y.a,{variant:"body1",children:"Following"})]})]})})]})})]})})})}):Object(ke.jsx)(y.a,{children:"Loading..."})})},It=a(86),Ft=function(e){var t=e.component,a=Object(It.a)(e,["component"]),n=s.a.useContext(ce).authState;return Object(ke.jsx)(m.b,Object(u.a)(Object(u.a)({},a),{},{render:function(e){return n.isAuthenticated?Object(ke.jsx)(t,Object(u.a)({},e)):Object(ke.jsx)(m.a,{to:"/login"})}}))},Wt=function(e){var t=e.component,a=Object(It.a)(e,["component"]),n=s.a.useContext(ce).authState;return Object(ke.jsx)(m.b,Object(u.a)(Object(u.a)({},a),{},{render:function(e){return n.isAuthenticated?Object(ke.jsx)(m.a,{to:"/"}):Object(ke.jsx)(t,Object(u.a)({},e))}}))},Dt=a(122),At=a.n(Dt),Gt=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){return Object(ke.jsxs)(s.a.Fragment,{children:[Object(ke.jsx)(y.a,{variant:"h1",color:"initial",align:"center",children:"404"}),Object(ke.jsx)(y.a,{variant:"h4",color:"initial",align:"center",children:"Page Not Found!"}),Object(ke.jsx)(Ae.a,{mt:2,align:"center",children:Object(ke.jsxs)(I.a,{color:"primary",component:b.b,to:"/",children:[Object(ke.jsx)(At.a,{})," Go to home"]})})]})}}]),a}(n.Component),Ut=Object(re.a)((function(e){return{margin:{marginTop:e.spacing(3)},relative:{position:"relative"},progressbar:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12},success:{color:e.palette.success.main}}}));var Bt=function(){var e=Ut(),t=s.a.useState({email:""}),a=Object(j.a)(t,2),n=a[0],r=a[1],i=s.a.useState(!1),o=Object(j.a)(i,2),c=o[0],l=o[1],d=s.a.useState(!1),u=Object(j.a)(d,2),b=u[0],m=u[1],h=s.a.useState(!1),O=Object(j.a)(h,2),p=O[0],x=O[1],g=Object(de.b)().enqueueSnackbar;return Object(ke.jsx)(ke.Fragment,{children:Object(ke.jsx)(W.a,{maxWidth:"xs",disableGutters:!0,children:Object(ke.jsxs)(Ae.a,{mt:5,children:[Object(ke.jsxs)(y.a,{variant:"h4",color:"initial",children:["Forget ",Object(ke.jsx)("br",{}),"Password"]}),Object(ke.jsx)(y.a,{variant:"body1",color:"inherit",children:"Enter your email to generate reset password link."}),p&&Object(ke.jsx)(y.a,{variant:"body1",className:Object(xt.a)(e.margin,e.success),children:"Reset password link generated successfully."}),Object(ke.jsxs)("form",{onSubmit:function(e){if(e.preventDefault(),!c&&n.email){m(!0);var t={email:n.email};fetch("".concat(Se.SERVER,"/auth/forget-pass"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(e){e.success?(g("Please check your mail for reset link",{variant:"success"}),x(!0)):g(e.message,{variant:"error"}),m(!1)})).catch((function(e){g("Failed to generate link!",{variant:"error"}),m(!1),console.error("Error:",e)}))}else g("Please enter a valid email",{variant:"Warning"})},children:[Object(ke.jsxs)(rt.a,{fullWidth:!0,className:e.margin,error:c,children:[Object(ke.jsx)(it.a,{htmlFor:"userEmail",children:"Enter Your Registered Email"}),Object(ke.jsx)(ot.a,{id:"userEmail",type:"email",value:n.email,onChange:function(e){r({email:e.target.value}),l(!Object(Pe.validateEmail)(e.target.value))}})]}),Object(ke.jsxs)(rt.a,{fullWidth:!0,className:Object(xt.a)(e.margin,e.relative),children:[Object(ke.jsxs)(I.a,{variant:"contained",color:"primary",disabled:b,type:"submit",children:[p?"Resend":"Send"," Reset Link"]}),b&&Object(ke.jsx)(ve.a,{size:24,className:e.progressbar})]})]})]})})})},Mt=a(224),zt=a(221),Vt=Object(re.a)((function(e){return{margin:{marginTop:e.spacing(3)},relative:{position:"relative"},progressbar:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}}}));function qt(){var e=Vt(),t=s.a.useState({oldPassword:"",password:"",confirmPassword:"",showPassword:!1,showOldPassword:!1}),a=Object(j.a)(t,2),n=a[0],r=a[1],i=s.a.useState({password:!1,confirmPassword:!1}),o=Object(j.a)(i,2),c=o[0],l=o[1],d=s.a.useState({submit:!1}),b=Object(j.a)(d,2),m=b[0],h=b[1],p=Object(de.b)().enqueueSnackbar,g=function(e){return function(t){r(Object(u.a)(Object(u.a)({},n),{},Object(O.a)({},e,t.target.value))),"password"===e?l({password:!Object(Pe.validatePassword)(t.target.value)}):"confirmPassword"===e&&l({confirmPassword:t.target.value!==n.password})}},f=function(e){e.preventDefault()};return Object(ke.jsx)(s.a.Fragment,{children:Object(ke.jsxs)("form",{onSubmit:function(e){if(e.preventDefault(),console.log("change pass submitted"),!c.password&&!c.confirmPassword&&n.password&&n.oldPassword){h({submit:!0});var t={oldPassword:n.oldPassword,password:n.password,confirmPassword:n.confirmPassword};fetch("".concat(Se.SERVER,"/auth/update-pass"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(e){e.success?(p("Password Changed successfully!",{variant:"success"}),r({oldPassword:"",password:"",confirmPassword:"",showPassword:!1,showOldPassword:!1})):p(e.message,{variant:"error"}),h({submit:!1})})).catch((function(e){p("Password Change failed!",{variant:"error"}),h({submit:!1}),console.error("Error:",e)}))}else p("Current password or new password should be valid.",{variant:"warning"})},children:[Object(ke.jsxs)(rt.a,{fullWidth:!0,className:e.margin,children:[Object(ke.jsx)(it.a,{htmlFor:"userCurrentPassword",children:"Current Password"}),Object(ke.jsx)(ot.a,{id:"userCurrentPassword",type:n.showOldPassword?"text":"password",value:n.oldPassword,onChange:g("oldPassword"),endAdornment:Object(ke.jsx)(ct.a,{position:"end",children:Object(ke.jsx)(x.a,{"aria-label":"toggle confirm password visibility",onClick:function(){r(Object(u.a)(Object(u.a)({},n),{},{showOldPassword:!n.showOldPassword}))},onMouseDown:f,children:n.showOldPassword?Object(ke.jsx)(jt.a,{}):Object(ke.jsx)(bt.a,{})})})})]}),Object(ke.jsxs)(rt.a,{fullWidth:!0,className:e.margin,error:c.password,children:[Object(ke.jsx)(it.a,{htmlFor:"userPassword",children:"New Password"}),Object(ke.jsx)(ot.a,{id:"userPassword",type:n.showPassword?"text":"password",value:n.password,onChange:g("password"),endAdornment:Object(ke.jsx)(ct.a,{position:"end",children:Object(ke.jsx)(x.a,{"aria-label":"toggle password visibility",onClick:function(){r(Object(u.a)(Object(u.a)({},n),{},{showPassword:!n.showPassword}))},onMouseDown:f,children:n.showPassword?Object(ke.jsx)(jt.a,{}):Object(ke.jsx)(bt.a,{})})})}),Object(ke.jsx)(vt.a,{children:"Use 8 or more characters with a mix of letters, numbers & symbols"})]}),Object(ke.jsxs)(rt.a,{fullWidth:!0,className:e.margin,error:c.confirmPassword,children:[Object(ke.jsx)(it.a,{htmlFor:"userConfirmPassword",children:"Confirm Password"}),Object(ke.jsx)(ot.a,{id:"userConfirmPassword",type:n.showPassword?"text":"password",value:n.confirmPassword,onChange:g("confirmPassword")})]}),Object(ke.jsxs)(rt.a,{className:Object(xt.a)(e.margin,e.relative),children:[Object(ke.jsx)(I.a,{variant:"contained",color:"primary",type:"submit",disabled:m.submit,children:"Change Password"}),m.submit&&Object(ke.jsx)(ve.a,{size:24,className:e.progressbar})]})]})})}var Jt=Object(re.a)((function(e){return{submit:{position:"relative"},progressbar:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12},margin:{marginTop:e.spacing(3)},form:{marginBottom:e.spacing(4)}}}));function Ht(){var e=Jt(),t=s.a.useContext(le),a=s.a.useContext(ce).authDispatch,n=s.a.useState({name:"",email:"",bio:"",website:"",location:""}),r=Object(j.a)(n,2),i=r[0],o=r[1],c=s.a.useState(!1),l=Object(j.a)(c,2),d=l[0],b=l[1],m=Object(de.b)().enqueueSnackbar;return s.a.useEffect((function(){t&&o({name:t.name,email:t.email,bio:t.bio,website:t.website,location:t.location})}),[t]),Object(ke.jsx)(s.a.Fragment,{children:Object(ke.jsxs)("form",{onSubmit:function(e){e.preventDefault(),b(!0);var t={email:i.email,name:i.name,bio:i.bio,location:i.location,website:i.website};fetch("".concat(Se.SERVER,"/users/update-profile"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(e){e.success?(m("Profile updated!",{variant:"success"}),a({type:"REFUSER"})):(401===e.status&&a({type:"LOGOUT"}),m(e.message,{variant:"error"})),b(!1)})).catch((function(e){m("Profile updation Failed",{variant:"error"}),b(!1),console.error("Error:",e)}))},className:e.form,children:[Object(ke.jsxs)(rt.a,{fullWidth:!0,className:e.margin,children:[Object(ke.jsx)(it.a,{htmlFor:"userName",children:"Name"}),Object(ke.jsx)(ot.a,{type:"text",id:"userName",value:i.name,onChange:function(e){return o(Object(u.a)(Object(u.a)({},i),{},{name:e.target.value}))}})]}),Object(ke.jsxs)(rt.a,{fullWidth:!0,className:e.margin,children:[Object(ke.jsx)(it.a,{htmlFor:"userEmail",children:"Email"}),Object(ke.jsx)(ot.a,{type:"email",id:"userEmail",value:i.email,onChange:function(e){return o(Object(u.a)(Object(u.a)({},i),{},{email:e.target.value}))}})]}),Object(ke.jsx)(rt.a,{fullWidth:!0,className:e.margin,children:Object(ke.jsx)(ge.a,{fullWidth:!0,id:"userBio",rows:3,label:"Write something about you",value:i.bio,multiline:!0,maxLength:"200",onChange:function(e){return o(Object(u.a)(Object(u.a)({},i),{},{bio:e.target.value}))}})}),Object(ke.jsxs)(rt.a,{fullWidth:!0,className:e.margin,children:[Object(ke.jsx)(it.a,{htmlFor:"userLocation",children:"Location"}),Object(ke.jsx)(ot.a,{type:"text",id:"userLocation",value:i.location,onChange:function(e){return o(Object(u.a)(Object(u.a)({},i),{},{location:e.target.value}))}})]}),Object(ke.jsxs)(rt.a,{fullWidth:!0,className:e.margin,children:[Object(ke.jsx)(it.a,{htmlFor:"userWebsite",children:"Website"}),Object(ke.jsx)(ot.a,{type:"url",id:"userWebsite",value:i.website,onChange:function(e){return o(Object(u.a)(Object(u.a)({},i),{},{website:e.target.value}))}})]}),Object(ke.jsxs)(rt.a,{className:Object(xt.a)(e.submit,e.margin),children:[Object(ke.jsx)(I.a,{variant:"contained",color:"primary",type:"submit",disabled:d,children:"Update Profile"}),d&&Object(ke.jsx)(ve.a,{size:24,className:e.progressbar})]})]})})}var $t=Object(re.a)((function(e){return{root:Object(O.a)({},e.breakpoints.up("sm"),{margin:e.spacing(2)}),mrBottom:{marginBottom:e.spacing(3)},mrTop:{marginTop:e.spacing(3)}}}));function Zt(){var e=$t(),t=s.a.useState(0),a=Object(j.a)(t,2),n=a[0],r=a[1];return Object(ke.jsx)(s.a.Fragment,{children:Object(ke.jsxs)(Ae.a,{className:e.root,children:[Object(ke.jsx)(y.a,{variant:"h4",className:e.mrBottom,children:"Account Settings"}),Object(ke.jsxs)(Mt.a,{value:n,onChange:function(e,t){r(t)},indicatorColor:"primary",textColor:"primary",style:{overflow:"auto"},children:[Object(ke.jsx)(zt.a,{label:"Profile"}),Object(ke.jsx)(zt.a,{label:"Password"})]}),Object(ke.jsx)(g.a,{}),0===n&&Object(ke.jsxs)(Ae.a,{index:0,className:e.mrTop,style:{display:"flex"},children:[Object(ke.jsx)(W.a,{maxWidth:"xs",disableGutters:!0,children:Object(ke.jsx)(Ht,{})}),Object(ke.jsx)("div",{style:{flexGrow:1}})]}),1===n&&Object(ke.jsxs)(Ae.a,{index:1,style:{display:"flex"},children:[Object(ke.jsx)(W.a,{maxWidth:"xs",disableGutters:!0,children:Object(ke.jsx)(qt,{})}),Object(ke.jsx)("div",{style:{flexGrow:1}})]})]})})}var _t=Object(re.a)((function(e){return{root:Object(O.a)({display:"flex"},e.breakpoints.up("sm"),{margin:e.spacing(2)}),marginBottom:{marginBottom:e.spacing(3)}}}));var Yt=function(){var e=s.a.useContext(ce).authState,t=_t();return Object(ke.jsx)(s.a.Fragment,{children:Object(ke.jsx)(Ae.a,{className:t.root,children:Object(ke.jsxs)(W.a,{maxWidth:"sm",disableGutters:!0,children:[Object(ke.jsx)(y.a,{variant:"h4",className:t.marginBottom,children:"Feed"}),Object(ke.jsx)(Xe,{authState:e,url:"/posts/feed/"})]})})})},Kt=Object(re.a)((function(e){return{root:Object(O.a)({display:"flex"},e.breakpoints.up("sm"),{margin:e.spacing(2)}),marginBottom:{marginBottom:e.spacing(3)}}}));var Qt=function(){var e=s.a.useContext(ce).authState,t=Kt();return Object(ke.jsx)(s.a.Fragment,{children:Object(ke.jsx)(Ae.a,{className:t.root,children:Object(ke.jsxs)(W.a,{maxWidth:"sm",disableGutters:!0,children:[Object(ke.jsx)(y.a,{variant:"h4",className:t.marginBottom,children:"Trending"}),Object(ke.jsx)(Xe,{authState:e,url:"/posts/trending/"})]})})})};var Xt=function(){var e=Object(m.i)().postId,t=s.a.useState(),a=Object(j.a)(t,2),n=a[0],r=a[1],i=s.a.useState("Loading..."),o=Object(j.a)(i,2),c=o[0],l=o[1],d=Object(de.b)().enqueueSnackbar;return s.a.useEffect((function(){fetch("".concat(Se.SERVER,"/posts/byid?postId=").concat(e),{method:"GET",credentials:"include"}).then((function(e){return e.json()})).then((function(e){e.success?r(e.post):(r(),l("Request post is either deleted or post id is wrong"),d(e.message,{variant:"error"}))})).catch((function(e){r(),l("Failed to get post"),d("Failed to get post",{variant:"error"}),console.error("Error:",e)}))}),[e,d]),Object(ke.jsx)(ke.Fragment,{children:n?Object(ke.jsx)(Qe,{post:n,notSkeleton:!0,single:!0}):Object(ke.jsx)(y.a,{variant:"subtitle1",color:"inherit",children:c})})},ea=Object(re.a)((function(e){return{margin:{marginTop:e.spacing(3)},relative:{position:"relative"},progressbar:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12},marginLow:{marginTop:e.spacing(1)}}}));var ta=function(){var e=ea(),t=Object(m.i)().token,a=s.a.useState({password:"",confirmPassword:"",resetPasswordToken:t.split(":")[0],tokenId:t.split(":")[1]}),n=Object(j.a)(a,2),r=n[0],i=n[1],o=s.a.useState({password:!1,confirmPassword:!1}),c=Object(j.a)(o,2),l=c[0],d=c[1],h=s.a.useState(!1),p=Object(j.a)(h,2),g=p[0],f=p[1],v=Object(de.b)().enqueueSnackbar,w=Object(m.g)(),P=function(e){return function(t){i(Object(u.a)(Object(u.a)({},r),{},Object(O.a)({},e,t.target.value))),"password"===e?d({password:!Object(Pe.validatePassword)(t.target.value)}):"confirmPassword"===e&&d({confirmPassword:t.target.value!==r.password})}};return Object(ke.jsx)(ke.Fragment,{children:Object(ke.jsx)(W.a,{maxWidth:"xs",disableGutters:!0,children:Object(ke.jsxs)(Ae.a,{mt:5,children:[Object(ke.jsxs)(y.a,{variant:"h4",color:"initial",children:["Reset ",Object(ke.jsx)("br",{}),"Password"]}),Object(ke.jsx)(y.a,{variant:"body1",color:"inherit",children:"Enter your new password to reset password."}),Object(ke.jsxs)("form",{onSubmit:function(e){if(e.preventDefault(),r.password&&r.resetPasswordToken&&r.tokenId&&!l.password&&!l.confirmPassword){f(!0);var t={password:r.password,confirmPassword:r.confirmPassword,resetPasswordToken:r.resetPasswordToken,tokenId:r.tokenId};fetch("".concat(Se.SERVER,"/auth/reset-pass"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(e){e.success?(v("Password Changed successfully!",{variant:"success"}),i({oldPassword:"",password:"",confirmPassword:"",showPassword:!1,showOldPassword:!1}),w.push("/login")):v(e.message,{variant:"error"}),f(!1)})).catch((function(e){v("Password reset failed!",{variant:"error"}),f(!1),console.error("Error:",e)}))}else v("Please enter valid password or confirm password",{variant:"Warning"})},children:[Object(ke.jsxs)(rt.a,{fullWidth:!0,className:e.margin,error:l.password,children:[Object(ke.jsx)(it.a,{htmlFor:"userPassword",children:"New Password"}),Object(ke.jsx)(ot.a,{id:"userPassword",type:r.showPassword?"text":"password",value:r.password,onChange:P("password"),endAdornment:Object(ke.jsx)(ct.a,{position:"end",children:Object(ke.jsx)(x.a,{"aria-label":"toggle password visibility",onClick:function(){i(Object(u.a)(Object(u.a)({},r),{},{showPassword:!r.showPassword}))},onMouseDown:function(e){e.preventDefault()},children:r.showPassword?Object(ke.jsx)(jt.a,{}):Object(ke.jsx)(bt.a,{})})})}),Object(ke.jsx)(vt.a,{children:"Use 8 or more characters with a mix of letters, numbers & symbols"})]}),Object(ke.jsxs)(rt.a,{fullWidth:!0,className:e.marginLow,error:l.confirmPassword,children:[Object(ke.jsx)(it.a,{htmlFor:"userConfirmPassword",children:"Confirm Password"}),Object(ke.jsx)(ot.a,{id:"userConfirmPassword",type:r.showPassword?"text":"password",value:r.confirmPassword,onChange:P("confirmPassword")})]}),Object(ke.jsx)(rt.a,{className:e.margin,children:Object(ke.jsx)(lt.a,{component:b.b,to:"/forgetpass",color:"primary",children:"Resend reset password Link?"})}),Object(ke.jsxs)(rt.a,{fullWidth:!0,className:Object(xt.a)(e.margin,e.relative),children:[Object(ke.jsx)(I.a,{variant:"contained",color:"primary",disabled:g,type:"submit",children:"Reset Password"}),g&&Object(ke.jsx)(ve.a,{size:24,className:e.progressbar})]})]})]})})})},aa=function(e,t){switch(t.type){case"LOGIN":return Object(u.a)(Object(u.a)({},e),{},{isAuthenticated:!0,userId:t.payload.userId,username:t.payload.username});case"LOGOUT":return Object(u.a)(Object(u.a)({},e),{},{isAuthenticated:!1,userId:null,username:null});case"REFPOST":return Object(u.a)(Object(u.a)({},e),{},{refreshPost:!e.refreshPost});case"REFUSER":return Object(u.a)(Object(u.a)({},e),{},{refreshUser:!e.refreshUser});default:return e}};var na=function(e){var t=e.initialState,a=s.a.useReducer(aa,t),n=Object(j.a)(a,2),r=n[0],i=n[1];return Object(ke.jsx)(s.a.Fragment,{children:Object(ke.jsx)(b.a,{children:Object(ke.jsxs)(de.a,{anchorOrigin:{vertical:"bottom",horizontal:"right"},maxSnack:2,children:[Object(ke.jsx)(ce.Provider,{value:{authState:r,authDispatch:i},children:Object(ke.jsx)(De,{children:Object(ke.jsxs)(m.d,{children:[Object(ke.jsx)(Ft,{exact:!0,path:"/",component:tt}),Object(ke.jsx)(Wt,{exact:!0,path:"/login",component:ft}),Object(ke.jsx)(Wt,{exact:!0,path:"/forgetpass",component:Bt}),Object(ke.jsx)(Wt,{exact:!0,path:"/forgetpass/:token",component:ta}),Object(ke.jsx)(Wt,{exact:!0,path:"/register",component:yt}),Object(ke.jsx)(Ft,{exact:!0,path:"/settings",component:Zt}),Object(ke.jsx)(Ft,{exact:!0,path:"/feed",component:Yt}),Object(ke.jsx)(Ft,{exact:!0,path:"/trending",component:Qt}),Object(ke.jsx)(Ft,{exact:!0,path:"/posts/:postId",component:Xt}),Object(ke.jsx)(Ft,{exact:!0,path:"/users/:username",component:Lt}),Object(ke.jsx)(m.b,{component:Gt})]})})}),Object(ke.jsx)(h,{})]})})})},sa=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={initialState:null},n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;fetch("".concat(Se.SERVER,"/auth/"),{method:"GET",credentials:"include"}).then((function(e){return e.json()})).then((function(t){t.success?e.setState({initialState:{isAuthenticated:!0,userId:t.userId,username:t.username,refreshPost:!1,refreshUser:!1}}):e.setState({initialState:{isAuthenticated:!1,userId:null,username:null,refreshPost:!1,refreshUser:!1}})})).catch((function(t){e.setState({initialState:{isAuthenticated:!1,userId:null,username:null,refreshUser:!1,refreshPost:!1}})}))}},{key:"render",value:function(){return this.state.initialState?Object(ke.jsx)(na,{initialState:this.state.initialState}):Object(ke.jsx)("p",{children:"Loading..."})}}]),a}(n.Component),ra=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ia(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}i.a.render(Object(ke.jsx)(sa,{}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");ra?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):ia(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):ia(t,e)}))}}()},29:function(e,t){var a=new RegExp(/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/),n=new RegExp(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,16}$/),s=new RegExp(/^(?=.{4,20}$)[a-zA-Z0-9]*$/),r=new RegExp(/^.{10,255}$/);e.exports={validateEmail:function(e){return a.test(e)},validatePassword:function(e){return n.test(e)},validateUsername:function(e){return s.test(e)},validatePostText:function(e){return r.test(e)}}}},[[154,1,2]]]);
//# sourceMappingURL=main.2ca69f0a.chunk.js.map